function readpage(e,t){rs.readpage(e,t)}function rshlsetContent(e){rs.rshlsetContent(e)}function rshlsetId(e){rs.rshlsetId(e)}function rshlinit(){rs.rshlinit()}function rshlsync(e,t){for(var s=e.split(","),r=t.split(","),n=0;n<e.length;n++)rs.rshlsync(s[n],r[n])}function rshlexit(){rs.rshlexit()}var rs={settings:{usePopupButton:!1,usePopupPlayer:!0,useReadspeakerIcon:!1,usePost:!1,wordColor:"#a4cbff",sentColor:"#beffd6",textColor:"#000000",defaultspeed:100,appserverhost:"app.readspeaker.com",flashParams:"&autoplay=1&rskin=bump&time_format=ms",flashLink:document.location.protocol+"//media.readspeaker.com/flash/readspeaker20.swf",allowScriptAccess:null,protocol:document.location.protocol||"http:",rsent:"rsent",defaultsync:"wordsent",version:"1.01-embhl",reloadPage:!1},phrases:{closeplayer:"St&auml;ng spelare",fast:"H&ouml;g",hide:"D&ouml;lj",highlightingoptions:"Markeringsval",listentoselectedtext:"Lyssna pÃ¥ markerad text",medium:"Normal",nohighlighting:"Ingen markering",nosound:"Inget ljud?",pause:"Paus",playerwidth:"285",play:"Play",popupbutton:"Popup-knapp",sentonly:"Enbart meningar",settings:"Inst&auml;llningar",show:"Visa",slow:"L&aring;ngsam",speechenabled:"Talsatt av <a href='http://www.readspeaker.com/sv' target='_blank'>ReadSpeaker</a>",speed:"L&auml;shastighet",stop:"Stopp",volume:"Volym",wordonly:"Enbart ord",wordsent:"Ord och meningar"},thesync:"none",thespeed:100,state:"NO_ACTION",defaultsurvive:36e7,bmindex:1,sentbmindex:0,seltexttimes:0,seltextcleanuptimes:0,startofsentence:1,inc:0,start:null,stop:null,newhtml:"",startOffset:null,endOffset:null,selectedString:"",selhtml:"",selectedWordsRange:[],firstrun:1,selectedRange:null,globalcount:null,oldwordhl_FF:[],oldwordhlclass_FF:[],oldsenthl_FF:[],oldsenthlclass_FF:[],oldwordhlrange_IE:[],oldwordhlbackcol_IE:[],oldwordhlforecol_IE:[],oldwordhl_IE:[],oldwordhlclass_IE:[],oldsenthlrange_IE:[],oldsenthlbackcol_IE:[],oldsenthlforecol_IE:[],oldsenthl_IE:[],oldsenthlclass_IE:[],oldbodyclass:null,exludednodes:["table","tr","select","option","textarea","ul","ol","dl","thead","tbody","tfoot","colgroup","script","map","optgroup"],data:{restorehtml:[],readid:[],current:{restorehtml:null,readid:null,playerid:null},previous:{playerid:null,sync:null}},convertSpeed:function(e){switch(e){case"slow":return rs.settings.defaultspeed-25;case"medium":return rs.settings.defaultspeed;case"fast":return rs.settings.defaultspeed+25;default:return rs.settings.defaultspeed}},issuePOST:function(e,t){if(rs.globalcount++,!document.getElementById("postiframe1")||!document.getElementById("postiframe2")||!document.getElementById("postiframe3")){var s=null;document.selection?s=document.createElement('<iframe name="postiframe'+rs.globalcount+'">'):(s=document.createElement("iframe"),s.name="postiframe"+rs.globalcount),s.setAttribute("id","postiframe"+rs.globalcount),s.setAttribute("style","display: none; position: absolute;"),s.style.display="none";var r=document.getElementsByTagName("body"),n=null;if(r.length>0)var n=r.item(0);if(!n)return;n.appendChild(s)}e+="&output=audiolink";var o=document.createElement("form");o.target="postiframe"+rs.globalcount,o.method="post";var a=e.split("?"),l=Math.random();o.action=rs.settings.protocol+"//"+rs.settings.appserverhost+"/enterprise/iframeproxy.php?rsent="+rs.settings.rsent+"&randid="+l;var i,d=a[1].split("&");for(i=0;i<d.length;i++){var p=d[i].split("="),c=document.createElement("input");c.setAttribute("name",unescape(p[0])),c.setAttribute("value",unescape(p[1])),o.appendChild(c)}var c=document.createElement("input");return"PLAYING_NO_SELECTION"==rs.state&&rs.settings.usePost?c.setAttribute("name","html_base64"):c.setAttribute("name","selectedhtml_base64"),c.setAttribute("value",rs.base64.encode(t)),o.appendChild(c),document.body.appendChild(o),o.submit(),document.body.removeChild(o),rs.settings.protocol+"//"+rs.settings.appserverhost+"/enterprise/iframeproxy.php?rsent="+rs.settings.rsent+"&listen=1&randid="+l},removeiFrames:function(){document.getElementById("postiframe1")&&document.body.removeChild(document.getElementById("postiframe1")),document.getElementById("postiframe2")&&document.body.removeChild(document.getElementById("postiframe2")),document.getElementById("postiframe3")&&document.body.removeChild(document.getElementById("postiframe3"))},readpage:function(e,t){rs.globalcount=0,rs.getreadids(),rs.popup.time&&(clearTimeout(rs.popup.time),rs.popup.setVisibility()),null===rs.settings.allowScriptAccess&&(-1==rs.settings.flashLink.indexOf("media.readspeaker.com")?rs.settings.allowScriptAccess="sameDomain":rs.settings.allowScriptAccess="always"),(navigator.userAgent.toLowerCase().indexOf("iphone")>-1||navigator.userAgent.toLowerCase().indexOf("ipad")>-1||navigator.userAgent.toLowerCase().indexOf("ipod")>-1)&&navigator.vendor.toLowerCase().indexOf("apple")>-1&&(rs.html5.inUse=!0),rs.thespeed=rs.convertSpeed(rs.loadSettings("ReadSpeakerHLspeed")),-1==rs.state.indexOf("USER_SELECTION")&&(rs.data.previous.sync=rs.thesync),rs.thesync=rs.loadSettings("ReadSpeakerHL"),null!==rs.thesync&&""!==rs.thesync||(rs.thesync=rs.settings.defaultsync);var s=e.match(/readid=[^&]+/gi);if(rs.data.current.readid=s[0].replace("readid=",""),rs.data.current.playerid=t,null!==rs.data.previous.playerid){var r=null;r=document.getElementById(rs.data.previous.playerid),r&&(r.innerHTML="",r.style.display="none")}if(rs.data.previous.playerid=rs.data.current.playerid,"USER_SELECTION"==rs.state||"USER_SELECTION_WHILE_PLAYING_USER_SELECTION"==rs.state||"USER_SELECTION_WHILE_PLAYING_NO_SELECTION"==rs.state||"SETTINGS_CHANGED_PLAYING_USER_SELECTION"==rs.state)rs.cleanup(),"SETTINGS_CHANGED_PLAYING_USER_SELECTION"!=rs.state&&(rs.selhtml=rs.selectRange()),document.selection&&document.execCommand("Unselect"),rs.state="PLAYING_USER_SELECTION";else if(rs.state="PLAYING_NO_SELECTION","none"==rs.data.previous.sync&&"none"==rs.thesync||rs.cleanup(),rs.settings.usePost&&null!==rs.data.current.readid){var n=document.getElementById(rs.data.current.readid);null!==n&&(rs.data.current.restorehtml=n.innerHTML)}rs.html5.inUse?rs.html5.player(e):"rs_popup_player"==rs.data.current.playerid?rs.popup.player(e):rs.player(e),rs.selectedString=""},player:function(e){if("PLAYING_NO_SELECTION"!=rs.state)var t=encodeURIComponent(rs.issuePOST(e+"&audioformat=flv&sync=user&speed="+rs.thespeed+"&rsjs_ver="+rs.settings.version+"&syncalignuser="+rs.thesync,rs.selhtml)),s=rs.issuePOST(e+"&speed="+rs.thespeed+"&rsjs_ver="+rs.settings.version,rs.selhtml);else if(rs.settings.usePost)var t=encodeURIComponent(rs.issuePOST(e+"&audioformat=flv&sync="+rs.thesync+"&speed="+rs.thespeed+"&rsjs_ver="+rs.settings.version,"<div id='"+rs.data.current.readid+"'>"+rs.data.current.restorehtml+"</div>")),s=rs.issuePOST(e+"&speed="+rs.thespeed+"&rsjs_ver="+rs.settings.version,"<div id='"+rs.data.current.readid+"'>"+rs.data.current.restorehtml+"</div>");else var t=encodeURIComponent(e+"&audioformat=flv&sync="+rs.thesync+"&speed="+rs.thespeed+"&rsjs_ver="+rs.settings.version),s=e+"&speed="+rs.thespeed+"&rsjs_ver="+rs.settings.version;var r="<div id='rs_playerarea'>";r+="<div style='margin-bottom: 2px; width: 100%; height: 20px;'><span style='position: absolute; top: 0px; left: 0px;'><object type='application/x-shockwave-flash' data='"+rs.settings.flashLink+"?flv="+t+rs.settings.flashParams+"&text_play="+rs.phrases.play+"&text_pause="+rs.phrases.pause+"&text_stop="+rs.phrases.stop+"&text_vol="+rs.phrases.volume+"' style='height:20px; width:250px;'>",r+="<param name='movie' value='"+rs.settings.flashLink+"?flv="+t+rs.settings.flashParams+"&text_play="+rs.phrases.play+"&text_pause="+rs.phrases.pause+"&text_stop="+rs.phrases.stop+"&text_vol="+rs.phrases.volume+"'>",r+="<param name='quality' value='high'><param name='autostart' value='true'>",r+="<param name='allowScriptAccess' value='"+rs.settings.allowScriptAccess+"'><param name='bgcolor' value='#FFFFFF'>",r+="<param name='loop' value='false'></object></span>",r+="<span style='position: absolute; top: 4px; right: 4px;'><a style='border-style: none;' href='JavaScript:void(0);' onclick='rs.closepage(\""+rs.data.current.playerid+"\");return false'><img id='closebr' src='"+rs.settings.protocol+"//media.readspeaker.com/images/enterprise/default/close.png' alt='"+rs.phrases.closeplayer+"' title='"+rs.phrases.closeplayer+"'></a></span></div>",r+="<div id='bottomlinks'><a href='JavaScript:void(0);' class='rs_settings' onclick='rs.showcontrols(\""+e+'","'+rs.data.current.playerid+"\");return false'>"+rs.phrases.settings+"</a> | <a id='rsSaveBtn' href='"+s+"' target='rs' onclick='rs.removeiFrames(); return true;'>"+rs.phrases.nosound+"</a> | "+rs.phrases.speechenabled+"</div>",r+="<div id='controls'></div>",r+="</div>";var n=document.getElementById(rs.data.current.playerid);n&&(n.innerHTML=r,n.style.display="block")},getreadids:function(){if(0===rs.data.readid.length){for(var e=document.getElementsByTagName("A"),t=0;t<e.length;t++)if(e[t].getAttribute("href")&&-1!=e[t].getAttribute("href").indexOf(rs.settings.appserverhost+"/cgi-bin/"+rs.settings.rsent)&&"rsSaveBtn"!=e[t].id){var s=e[t].getAttribute("href").match(/readid=[^&]+/gi);if(s){var r=s[0].replace("readid=","");rs.data.readid.push(r)}}if(rs.data.readid.length>0)for(var n=null,o=0;o<rs.data.readid.length;o++)n=document.getElementById(rs.data.readid[o]),n&&rs.data.restorehtml.push(n.innerHTML)}},closepage:function(e){rs.html5.inUse&&rs.html5.controls.stop();var t=document.getElementById(e);t&&(t.innerHTML="",t.style.display="none"),rs.state="CLOSE";var s=document.getElementById(rs.data.current.readid);s&&s.className.toLowerCase().indexOf("rs_reload")>-1||rs.settings.reloadPage?setTimeout("location.reload(true);",500):(setTimeout("rs.cleanup();rs.data.current.restorehtml=null;",500),document.getElementById("rs_selimg")&&document.body.removeChild(document.getElementById("rs_selimg")),document.getElementById("rs_popup_player")&&document.body.removeChild(document.getElementById("rs_popup_player")))},rshlexit:function(){setTimeout("rs.cleanup();",500)},saveSettings:function(name,content,lifetime){if(lifetime=parseInt(eval(lifetime)),lifetime+""=="NaN")tmpdate="";else{var thedate=new Date;thedate.setTime(thedate.getTime()+lifetime),thedate=thedate.toGMTString(),tmpdate="; expires="+thedate}document.cookie=name+"="+escape(content)+tmpdate},loadSettings:function(e){for(ckarr=document.cookie,cks=ckarr.split("; "),i=0;i<cks.length;i++)for(cknameval=cks[i].split("="),j=0;j<cknameval.length;j++)if(cknameval[j]==e)return unescape(cknameval[j+1]);return""},setstyle:function(e){e.indexOf("icon")>-1?rs.saveSettings("ReadSpeakerHLicon",e,rs.defaultsurvive):"slow"==e||"medium"==e||"fast"==e?rs.saveSettings("ReadSpeakerHLspeed",e,rs.defaultsurvive):rs.saveSettings("ReadSpeakerHL",e,rs.defaultsurvive);var t=document.getElementById("controls");null!==t&&(t.innerHTML="")},showcontrols:function(e,t){var s=document.getElementById("controls");if(null!==s&&""!=s.innerHTML)return s.innerHTML="",s.style.display="none",!1;var r=rs.loadSettings("ReadSpeakerHL"),n=rs.loadSettings("ReadSpeakerHLicon"),o=rs.loadSettings("ReadSpeakerHLspeed");""==r&&(r=rs.settings.defaultsync),""==n&&(n=rs.settings.usePopupButton?"iconon":"iconoff"),""==o&&(o="medium"),thestring="<div id='rspopup'><fieldset class='rs_block'><legend>"+rs.phrases.highlightingoptions+"</legend><ul>",thestring+="<li class=","wordsent"==r&&(thestring+="'rs_active'"),thestring+="><a href='JavaScript:void(0);' onclick='rs.changeSettings(\""+e+'","'+t+'","wordsent");return false;\'>'+rs.phrases.wordsent+"</a></li>",thestring+="<li class=","sent"==r&&(thestring+="'rs_active'"),thestring+="><a href='JavaScript:void(0);' onclick='rs.changeSettings(\""+e+'","'+t+'","sent");return false;\'>'+rs.phrases.sentonly+"</a></li>",thestring+="<li class=","word"==r&&(thestring+="rs_active"),thestring+="><a href='JavaScript:void(0);' onclick='rs.changeSettings(\""+e+'","'+t+'","word");return false;\'>'+rs.phrases.wordonly+"</a></li>",thestring+="<li class=","none"==r&&(thestring+="rs_active"),thestring+="><a href='JavaScript:void(0);' onclick='rs.changeSettings(\""+e+'","'+t+'","none");return false;\'>'+rs.phrases.nohighlighting+"</a></li>",thestring+="</ul></fieldset><fieldset class='rs_block'><legend>"+rs.phrases.popupbutton+"</legend><ul>",thestring+="<li class=","iconon"==n&&(thestring+="rs_active "),thestring+="><a href='JavaScript:void(0);' onclick='rs.settings.usePopupButton=true;rs.changeSettings(\""+e+'","'+t+'","iconon");return false;\'>'+rs.phrases.show+"</a></li>",thestring+="<li class=","iconoff"==n&&(thestring+="rs_active "),thestring+="><a href='JavaScript:void(0);' onclick='rs.settings.usePopupButton=false;rs.changeSettings(\""+e+'","'+t+'","iconoff");return false;\'>'+rs.phrases.hide+"</a></li>",thestring+="</ul></fieldset><fieldset class='rs_block'><legend>"+rs.phrases.speed+"</legend><ul>",thestring+="<li class=","slow"==o&&(thestring+="rs_active "),thestring+="><a href='JavaScript:void(0);' onclick='rs.changeSettings(\""+e+'","'+t+'","slow");return false;\'>'+rs.phrases.slow+"</a></li>",thestring+="<li class=","medium"==o&&(thestring+="rs_active "),thestring+="><a href='JavaScript:void(0);' onclick='rs.changeSettings(\""+e+'","'+t+'","medium");return false;\'>'+rs.phrases.medium+"</a></li>",thestring+="<li class=","fast"==o&&(thestring+="rs_active "),thestring+="><a href='JavaScript:void(0);' onclick='rs.changeSettings(\""+e+'","'+t+'","fast");return false;\'>'+rs.phrases.fast+"</a></li>",thestring+="</ul></fieldset></div><div style='clear: both;'></div>";var s=document.getElementById("controls");null!==s&&(s.style.display="block",s.innerHTML=thestring)},changeSettings:function(e,t,s){rs.html5.inUse&&rs.html5.stop(),"PLAYING_NO_SELECTION"==rs.state?rs.state="SETTINGS_CHANGED_PLAYING_NO_SELECTION":rs.state="SETTINGS_CHANGED_PLAYING_USER_SELECTION",rs.setstyle(s),rs.readpage(e,t)},copyselected:function(e){return rs.popup.mouseRel(e),setTimeout("rs.getSelectedHTML()",50),!0},getSelectedHTML:function(){rs.selectedString="";var e=void 0,t=void 0;window.getSelection?(t=window.getSelection(),t.isCollapsed||(t.getRangeAt?e=t.getRangeAt(0):(e=document.createRange(),e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset)),e?(DOM=e.cloneContents(),object=document.createElement("div"),object.appendChild(DOM.cloneNode(!0)),rs.selectedString=object.innerHTML):rs.selectedString=t)):document.selection?(t=document.selection,e=t.createRange(),e&&e.htmlText&&e.text&&e.text.length>0?rs.selectedString=e.htmlText:e&&e.text&&(rs.selectedString=e.text)):document.getSelection&&(rs.selectedString=document.getSelection()),rs.popup.button(),rs.selectedString.length>0&&"NO_ACTION"==rs.state?rs.state="USER_SELECTION":rs.selectedString.length>0&&"PLAYING_USER_SELECTION"==rs.state?rs.state="USER_SELECTION_WHILE_PLAYING_USER_SELECTION":rs.selectedString.length>0&&"PLAYING_NO_SELECTION"==rs.state&&(rs.state="USER_SELECTION_WHILE_PLAYING_NO_SELECTION")},cleanup:function(){if(document.selection){if("USER_SELECTION"==rs.state||"USER_SELECTION_WHILE_PLAYING_USER_SELECTION"==rs.state||"USER_SELECTION_WHILE_PLAYING_NO_SELECTION"==rs.state){if(rs.oldwordhl_IE.length>0){for(var e=0;e<rs.oldwordhl_IE.length;e++)rs.oldwordhl_IE[e].className=rs.oldwordhlclass_IE[e];rs.oldwordhlclass_IE=[],rs.oldwordhl_IE=[]}if(rs.oldsenthl_IE.length>0){for(var e=0;e<rs.oldsenthl_IE.length;e++)rs.oldsenthl_IE[e].className=rs.oldsenthlclass_IE[e];rs.oldsenthl_IE=[],rs.oldsenthlclass_IE=[]}}if(rs.oldwordhlrange_IE.length>0){for(var e=0;e<rs.oldwordhlrange_IE.length;e++)rs.oldwordhlbackcol_IE[e]&&rs.oldwordhlforecol_IE&&(rs.oldwordhlrange_IE[e].execCommand("backcolor",0,rs.oldwordhlbackcol_IE[e]),null!==rs.oldwordhlforecol_IE[e]&&rs.oldwordhlrange_IE[e].execCommand("forecolor",0,rs.oldwordhlforecol_IE[e]));rs.oldwordhlrange_IE=[],rs.oldwordhlbackcol_IE=[],rs.oldwordhlforecol_IE=[]}if(rs.oldsenthlrange_IE.length>0){for(var e=0;e<rs.oldsenthlrange_IE.length;e++)rs.oldsenthlbackcol_IE[e]&&rs.oldsenthlforecol_IE&&(rs.oldsenthlrange_IE[e].execCommand("backcolor",0,rs.oldsenthlbackcol_IE[e]),null!==rs.oldsenthlforecol_IE[e]&&rs.oldsenthlrange_IE[e].execCommand("forecolor",0,rs.oldsenthlforecol_IE[e]));rs.oldsenthlrange_IE=[],rs.oldsenthlbackcol_IE=[],rs.oldsenthlforecol_IE=[]}"SETTINGS_CHANGED_PLAYING_USER_SELECTION"!=rs.state&&"PLAYING_USER_SELECTION"!=rs.state&&(rs.selectedWordsRange=[])}else{if("USER_SELECTION"==rs.state||"USER_SELECTION_WHILE_PLAYING_USER_SELECTION"==rs.state||"USER_SELECTION_WHILE_PLAYING_NO_SELECTION"==rs.state){var t=document.getElementsByTagName("RS:SPAN");for(e=t.length-1;e>-1;e--)t[e].className=t[e].className.replace("sync_sent_highlighted",""),t[e].className=t[e].className.replace("sync_word_highlighted","");var t=document.getElementsByTagName("RSI:SPAN");for(e=t.length-1;e>-1;e--)t[e].className=t[e].className.replace("sync_sent_highlighted",""),t[e].className=t[e].className.replace("sync_word_highlighted","")}if("PLAYING_USER_SELECTION"==rs.state||"SETTINGS_CHANGED_PLAYING_USER_SELECTION"==rs.state){if(rs.oldwordhl_FF.length>0){for(var e=0;e<rs.oldwordhl_FF.length;e++)rs.oldwordhl_FF[e].className=rs.oldwordhlclass_FF[e];rs.oldwordhlclass_FF=[],rs.oldwordhl_FF=[]}if(rs.oldsenthl_FF.length>0){for(var e=0;e<rs.oldsenthl_FF.length;e++)rs.oldsenthl_FF[e].className=rs.oldsenthlclass_FF[e];rs.oldsenthl_FF=[],rs.oldsenthlclass_FF=[]}}"CLOSE"!=rs.state&&"PLAYING_NO_SELECTION"!=rs.state||rs.cleanUpSpans()}if("CLOSE"==rs.state||"PLAYING_NO_SELECTION"==rs.state&&null!=rs.data.restorehtml&&null!=rs.data.readid)for(var s=null,r=0;r<rs.data.readid.length;r++)s=document.getElementById(rs.data.readid[r]),s&&null!==rs.data.restorehtml[r]&&(s.innerHTML=rs.data.restorehtml[r]);rs.html5.inUse&&rs.oldbodyclass&&(document.body.className=rs.html5.oldbodyclass),"CLOSE"==rs.state&&(rs.state="NO_ACTION",rs.data.restorehtml=[],rs.data.readid=[])},rshlsetContent:function(e){rs.newhtml+=e},rshlsetId:function(e){rs.data.current.readid=e},rshlinit:function(){if("PLAYING_USER_SELECTION"==rs.state||"USER_SELECTION_WHILE_PLAYING_USER_SELECTION"==rs.state)rs.firstrun=1,document.selection?document.selection.empty():rs.identifyElementsReplacementNode(document.body),rs.newhtml="";else if("none"!=rs.thesync){var e=null;null!==rs.data.current.readid&&(e=document.getElementById(rs.data.current.readid)),null!==e&&(e.innerHTML=rs.newhtml,rs.newhtml="")}else rs.newhtml="";rs.removeiFrames()},rshlsync:function(e,t){var s=!1;if(0==(2&e)&&(s=0!=(1&e)),"PLAYING_USER_SELECTION"==rs.state||"USER_SELECTION_WHILE_PLAYING_USER_SELECTION"==rs.state)if(document.selection){var r;if(r=rs.selectedWordsRange[t],1==rs.firstrun){if(rs.firstrun=0,rs.oldsenthlrange_IE&&rs.oldsenthlrange_IE.length>0){for(var n=0;n<rs.oldsenthlrange_IE.length;n++)rs.oldsenthlbackcol_IE[n]&&rs.oldsenthlforecol_IE&&(rs.oldsenthlrange_IE[n].execCommand("backcolor",0,rs.oldsenthlbackcol_IE[n]),null!==rs.oldsenthlforecol_IE[n]&&rs.oldsenthlrange_IE[n].execCommand("forecolor",0,rs.oldsenthlforecol_IE[n]));rs.oldsenthlrange_IE=[],rs.oldsenthlbackcol_IE=[],rs.oldsenthlforecol_IE=[]}if(rs.selectedWordsRange&&rs.selectedWordsRange.length>0&&"wordsent"==rs.thesync)for(var n=0;n<rs.selectedWordsRange.length;n++)rs.selectedWordsRange[n]&&(rs.oldsenthlrange_IE.push(rs.selectedWordsRange[n]),rs.oldsenthlbackcol_IE.push(rs.selectedWordsRange[n].queryCommandValue("backcolor")),rs.oldsenthlforecol_IE.push(rs.selectedWordsRange[n].queryCommandValue("forecolor")),""!=rs.selectedWordsRange[n].text&&(rs.selectedWordsRange[n].execCommand("backcolor",0,rs.settings.sentColor),rs.selectedWordsRange[n].execCommand("forecolor",0,rs.settings.textColor)))}if("wordsent"==rs.thesync||"sent"==rs.thesync||"word"==rs.thesync||""==rs.thesync){if(!s&&rs.oldwordhlrange_IE.length>0){for(var n=0;n<rs.oldwordhlrange_IE.length;n++)"word"==rs.thesync||"sent"==rs.thesync?rs.oldwordhlrange_IE[n].execCommand("backcolor",0,rs.oldwordhlbackcol_IE[n]):rs.oldwordhlrange_IE[n].execCommand("backcolor",0,rs.settings.sentColor),rs.oldwordhlrange_IE[n].execCommand("forecolor",0,rs.oldwordhlforecol_IE[n]);rs.oldwordhlrange_IE=[],rs.oldwordhlbackcol_IE=[],rs.oldwordhlforecol_IE=[]}rs.oldwordhlbackcol_IE.push(r.queryCommandValue("backcolor")),rs.oldwordhlforecol_IE.push(r.queryCommandValue("forecolor")),rs.oldwordhlrange_IE.push(r),"sent"==rs.thesync?r.execCommand("backcolor",0,rs.settings.sentColor):r.execCommand("backcolor",0,rs.settings.wordColor),r.execCommand("forecolor",0,rs.settings.textColor)}}else{var r;if(r=rs.selectedWordsRange["sync"+t],r.className.replace("word","")!=r.className){if(rs.oldwordhl_FF&&rs.oldwordhl_FF.length>0&&rs.oldwordhlclass_FF&&rs.oldwordhlclass_FF.length>0&&!s){for(var n=0;n<rs.oldwordhl_FF.length;n++)rs.oldwordhl_FF[n].className=rs.oldwordhlclass_FF[n];rs.oldwordhlclass_FF=[],rs.oldwordhl_FF=[]}"wordsent"!=rs.thesync&&"sent"!=rs.thesync&&"word"!=rs.thesync&&""!=rs.thesync||(rs.oldwordhlclass_FF.push(r.className),rs.oldwordhl_FF.push(r),"sent"==rs.thesync?r.className="sync_sent_highlighted":r.className="sync_word_highlighted")}if(1==rs.firstrun){if(rs.firstrun=0,rs.oldsenthl_FF.length>0){for(var n=0;n<rs.oldsenthl_FF.length;n++)rs.oldsenthl_FF[n].className=rs.oldsenthlclass_FF[n];rs.oldsenthl_FF=[],rs.oldsenthlclass_FF=[]}if("none"!=rs.thesync&&"word"!=rs.thesync&&"sent"!=rs.thesync)for(var o=rs.returnClassArraySubstring("ffsent"+rs.seltexttimes+" "),n=0;n<o.length;n++)rs.oldsenthl_FF[n]=o[n],rs.oldsenthlclass_FF[n]=rs.oldsenthl_FF[n].className,o[n].className="sync_sent_highlighted"}}else if(document.selection){var r;if(r=document.getElementById("sync"+t),r&&r.className.replace("word","")!=r.className){if(!s&&rs.oldwordhl_IE.length>0){for(var n=0;n<rs.oldwordhl_IE.length;n++)rs.oldwordhl_IE[n].className=rs.oldwordhlclass_IE[n];rs.oldwordhl_IE=[],rs.oldwordhlclass_IE=[]}rs.oldwordhlclass_IE.push(r.className),rs.oldwordhl_IE.push(r),r.className="sync_word_highlighted"}else if(r&&r.className.replace("sent","")!=r.className){if(!s&&rs.oldsenthl_IE.length>0){for(var n=0;n<rs.oldsenthl_IE.length;n++)rs.oldsenthl_IE[n].className=rs.oldsenthlclass_IE[n];rs.oldsenthl_IE=[],rs.oldsenthlclass_IE=[]}rs.oldsenthlclass_IE.push(r.className),rs.oldsenthl_IE.push(r),r.className="sync_sent_highlighted"}}else{var r;if(r=document.getElementById("sync"+t),r&&r.className.replace("word","")!=r.className){if(!s&&rs.oldwordhl_FF.length>0){for(var n=0;n<rs.oldwordhl_FF.length;n++)rs.oldwordhl_FF[n].className=rs.oldwordhlclass_FF[n];rs.oldwordhl_FF=[],rs.oldwordhlclass_FF=[]}rs.oldwordhlclass_FF.push(r.className),rs.oldwordhl_FF.push(r),r.className="sync_word_highlighted"}else if(r&&r.className.replace("sent","")!=r.className){if(!s&&rs.oldsenthl_FF.length>0){for(var n=0;n<rs.oldsenthl_FF.length;n++)rs.oldsenthl_FF[n].className=rs.oldsenthlclass_FF[n];rs.oldsenthl_FF=[],rs.oldsenthlclass_FF=[]}rs.oldsenthlclass_FF.push(r.className),rs.oldsenthl_FF.push(r),r.className="sync_sent_highlighted"}}},selectRange:function(){if(rs.seltexttimes++,document.selection)return rs.selectedRange=document.selection.createRange().duplicate(),rs.selectRangeIE(rs.selectedRange,-1);var e="",t=window.getSelection().getRangeAt(0);return rs.start=t.startContainer,rs.stop=t.endContainer,rs.startOffset=rs.modifyOffsetStartOfWord(rs.start,t.startOffset),rs.endOffset=rs.modifyOffsetEndOfWord(rs.stop,t.endOffset),rs.bmindex++,rs.sentbmindex=rs.bmindex,rs.bmindex++,rs.startofsentence=1,e=rs.rangeMarkupGecko(t.commonAncestorContainer),window.getSelection().removeAllRanges(),e},selectRangeIE:function(e){var t=e.duplicate();e.moveStart("word",-1),e.moveStart("word",1),t.isEqual(e)||e.moveStart("word",-1),t=e.duplicate(),e.moveEnd("word",1),e.moveEnd("word",-1),t.isEqual(e)||e.moveEnd("word",1);var s=e.duplicate(),r=0,n="",o=1,a=e.parentElement(),l=0;s.collapse();var i=s.duplicate();i.collapse(!1);for(var d=0;e.inRange(s)&&0!=e.compareEndPoints("EndToEnd",s)&&(d++,r++,!(r>1e4));){s.collapse(!1),s.expand("word",1);var p="",c="",m=s.duplicate();if(m.collapse(!1),i.collapse(!1),0==i.compareEndPoints("StartToStart",m)&&0==i.compareEndPoints("EndToEnd",m)&&m.htmlText==i.htmlText){if(l++,2>l)s.move("character",1);else if(4>l)s.move("character",2);else if(6>l)s.move("word",1);else if(8>l)s.move("word",2);else if(10>l)s.move("sentence",1);else{if(!(12>l))break;s.move("sentence",2)}s.collapse(!1)}else{if(l=0,-1==d)return s;rs.selectedWordsRange[d]=s.duplicate();var u=s.text,h=s.htmlText;s.collapse(!1);var g;o?(lastPos=s.duplicate(),g=rs.iterateParentTree(lastPos.parentElement(),document.body,a,0)):g=rs.iterateParentTree(s.parentElement(),lastPos.parentElement(),a,0);for(var f=rs.iterateParentTree(lastPos.parentElement(),s.parentElement(),a,0),y=s.parentElement(),_=0;g>_&&20>_;_++)y.className.match("sync_")||(p=y.outerHTML.match("<[^>]*>")[0]+p),y=y.parentElement;for(var y=lastPos.parentElement(),_=0;f>_&&20>_;_++)y.className.match("sync_")||(c+="</"+y.tagName+">"),y=y.parentElement;0==g&&0==f||(lastPos=s.duplicate()),o?(n+=p,o=0):n+=c+p,""!=h.replace("sync_sent_highlighted","")&&(n+="<rs:span class='sync_user' id='sync"+d+"'>"+u+"</rs:span>"),i=s.duplicate()}}n+="<!-- f -->";for(var f=rs.iterateParentTree(lastPos.parentElement(),document.body,a,0),y=lastPos.parentElement(),_=0;f>_;_++)y.className.match("sync_")||(n+="</"+y.tagName+">"),y=y.parentElement;return s.collapse(),n},iterateParentTree:function(e,t,s,r){for(var n=t;null!==n;){if(e==s)return r;if(e==n)return r;n=n.parentElement}return r++,rs.iterateParentTree(e.parentElement,t,s,r)},rangeMarkupGecko:function(e){rs.firstrun=1;var t="",s=rs.inc;if(3==e.nodeType)t+=rs.markup(e);else{var r,n="";if(e.hasChildNodes())for(r=0;r<e.childNodes.length;r++){var o=e.childNodes.item(r);if(o==rs.start&&(rs.inc=1),e==rs.start&&r==rs.startOffset&&(rs.inc=1),8!=o.nodeType&&(n+=rs.rangeMarkupGecko(o)),e==rs.stop&&r==rs.endOffset){rs.inc=0;break}if(o==rs.stop){rs.inc=0;break}}if(!s&&!rs.inc||e.className&&(e.className.replace("sync")!=e.className||e.id.replace("sync")!=e.id))t+=n;else{var a=document.createElement("div");a.appendChild(e.cloneNode(!0)),tempdivtag=a.innerHTML.match("<[^>]*>"),null!==tempdivtag&&tempdivtag.length>0?(t+=tempdivtag[0],t+=n,t+="</"+e.nodeName+">"):t+=n}if(e.hasChildNodes())for(r=0;r<e.childNodes.length;r++){if(e==rs.stop&&r==rs.endOffset){rs.inc=0;break}if(o==rs.stop){rs.inc=0;break}}}return t.replace(/rsi:span/g,"rs:span")},markup:function(e){var t,s=!0,r="",n="",o="",a=e.nodeValue;if(e==rs.start&&-1!=rs.startOffset&&e==rs.stop&&-1!=rs.endOffset?(n=e.nodeValue.substring(0,rs.startOffset),a=e.nodeValue.substring(rs.startOffset,rs.endOffset),o=e.nodeValue.substring(rs.endOffset),rs.inc=1):e==rs.start&&-1!=rs.startOffset?(n=e.nodeValue.substring(0,rs.startOffset),a=e.nodeValue.substring(rs.startOffset),rs.inc=1):e==rs.stop&&-1!=rs.endOffset&&(a=e.nodeValue.substring(0,rs.endOffset),o=e.nodeValue.substring(rs.endOffset),rs.inc=1),!rs.inc)return"";for(var t=0;t<rs.exludednodes.length;t++)if(e.parentNode&&e.parentNode.nodeName.toLowerCase()==rs.exludednodes[t]){s=!1,r=rs.htmlencode(a);break}if(s&&(r=rs.markupSentences(rs.htmlencode(a),null)),e==rs.stop&&-1!=rs.endOffset&&(rs.inc=0),s&&null!==e.parentNode&&""!=a){var l=rs.createreplacementnode(n+r+o,getComputedStyle(e.parentNode,null));e.parentNode.insertBefore(l,e),e.parentNode.removeChild(e)}return r},markupSentences:function(e){var t=rs.splitString(e,new Array(", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82")));if(!t)return"";for(var s="",r=0;r<t.length;r++)s+="<rsi:span class=' ffsent"+rs.seltexttimes+" cj"+rs.seltexttimes+"' ",s+="id='sync"+rs.sentbmindex+"'",rs.startofsentence=0,s+=">",s+=rs.markupWords(t[r]),s+="</rsi:span>";return s},markupWords:function(e){var t=rs.splitString(e," ");if(!t)return"";for(var s="",r=0;r<t.length;r++)s+="<rsi:span class='sync_user word ck"+rs.seltexttimes+"'",s+=" id='sync"+rs.bmindex++ +"'",s+=">",s+=t[r],s+="</rsi:span>";return s},trim:function(e){return e.replace(/^\s+|\s+$/g,"")},htmlencode:function(e){var t=document.createElement("div"),s=document.createTextNode(e);return t.appendChild(s),t.innerHTML},identifyElementsReplacementNode:function(e){if(e.tagName&&"RSI:SPAN"==e.tagName&&e.id&&(rs.selectedWordsRange[e.id]=e),e.hasChildNodes())for(var t=0;t<e.childNodes.length;t++){var s=e.childNodes.item(t);rs.identifyElementsReplacementNode(s)}},createreplacementnode:function(e,t){var s=document.createElement("rsi:span");return s.innerHTML=e,s.setAttribute("class","synctemp cl"+rs.seltexttimes),s},modifyOffsetStartOfWord:function(e,t){for(var s=new Array(" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"));e.nodeValue&&0!=t;){for(var r=0;r<s.length;r++)if(breakstr=s[r],0==e.nodeValue.substring(t-1).indexOf(breakstr))return t;t--}return t},modifyOffsetEndOfWord:function(e,t){for(var s=new Array(" ",", ",". ","! ","? ",decodeURIComponent("%e3%80%81"),decodeURIComponent("%e3%80%82"));e.nodeValue&&t!=e.nodeValue.length;){for(var r=0;r<s.length;r++)if(breakstr=s[r],0==e.nodeValue.substring(t-1).indexOf(breakstr))return t;t++}return t},returnClassArraySubstring:function(e){var t=document.getElementsByTagName("*"),s=0,r=[];for(i=0;i<t.length;i++)t[i].className.replace(e,"")!=t[i].className&&(r[s]=t[i],s++);return r},cleanUpSpans:function(){var e,t=document.getElementsByTagName("RSI:SPAN");for(i=t.length-1;i>-1;i--){for(e=document.createDocumentFragment(),j=0;j<t[i].childNodes.length;j++)e.appendChild(t[i].childNodes[j].cloneNode(!0));t[i].parentNode.replaceChild(e,t[i])}},splitString:function(e,t){for(var s=new Array(""),r=0,n=0;n<e.length;n++){for(var o=0;o<t.length;o++){for(var a=t[o],l=!0,i=0;i<a.length;i++)if(e.length-(n+i)<0||a[a.length-i-1]!=e[n-i-1]){l=!1;break}l&&(r++,s[r]="")}s[r]+=e[n]}return s},popup:{buttonExists:null,mouse_y_startpos:null,mouse_x_pos:null,mouse_y_pos:null,player_x_pos:null,player_y_pos:null,time:null,viewportwidth:null,viewportheight:null,button:function(){if(rs.popup.mouse_x_pos&&rs.popup.mouse_y_pos&&rs.selectedString.length>0){if(!document.getElementById("rs_selimg")){for(var e=null,t=document.getElementsByTagName("A"),s=[],r=0;r<t.length;r++)s[r]=t[r];for(var n=0;n<s.length;n++)if(s[n].getAttribute("href")&&-1!=s[n].getAttribute("href").indexOf(rs.settings.appserverhost+"/cgi-bin/"+rs.settings.rsent)&&"rsSaveBtn"!=s[n].id){rs.popup.buttonExists=!0,!rs.usersicon&&s[n].getElementsByTagName("img").length>0&&(e=s[n].getElementsByTagName("img")[0].src);for(var o=0;o<s[n].attributes.length;o++)if("href"==s[n].attributes[o].nodeName.toLowerCase())var a=s[n].attributes[o].nodeValue;else if("onclick"==s[n].attributes[o].nodeName.toLowerCase())var l=s[n].attributes[o].nodeValue;break}if(rs.popup.buttonExists){var i=document.createElement("img");!rs.settings.useReadspeakerIcon&&e||(e=rs.settings.protocol+"//media.readspeaker.com/images/buttons/listen_icons/icon_16px.gif"),i.setAttribute("src",e),i.style.border="none",i.setAttribute("alt",rs.phrases.listentoselectedtext),i.setAttribute("title",rs.phrases.listentoselectedtext);var d=document.createElement("a");d.setAttribute("id","rs_selimg"),d.setAttribute("href",a),rs.settings.usePopupPlayer&&(l="readpage(this.href,'rs_popup_player'); return false;"),""==l&&(l="readpage(this.href,'xp1'); return false;"),d.setAttribute("onclick","clearTimeout(rs.popup.time);rs.popup.setVisibility();"+l),d.setAttribute("onmouseover","clearTimeout(rs.popup.time);"),d.setAttribute("onmouseout","rs.popup.hideIcon();"),d.onclick=new Function("clearTimeout(rs.popup.time);rs.popup.setVisibility();"+l),d.onmouseover=new Function("clearTimeout(rs.popup.time);"),d.onmouseout=new Function("rs.popup.hideIcon();"),d.appendChild(i);var p=document.createDocumentFragment();p.appendChild(d),document.body.appendChild(p)}}if(rs.popup.buttonExists){var c=document.getElementById("rs_selimg");c.style.top=rs.popup.mouse_y_pos+"px",c.style.left=rs.popup.mouse_x_pos+"px",rs.popup.player_y_pos=rs.popup.mouse_y_pos+"px",rs.popup.player_x_pos=rs.popup.mouse_x_pos+"px";var m=rs.loadSettings("ReadSpeakerHLicon");""==m&&(m=rs.settings.usePopupButton?"iconon":"iconoff"),
"iconoff"==m?c.style.display="none":c.style.display="inline",rs.popup.hideIcon()}}},player:function(e){var t=encodeURIComponent(rs.issuePOST(e+"&audioformat=flv&sync=user&speed="+rs.thespeed+"&rsjs_ver="+rs.settings.version+"&syncalignuser="+rs.thesync,rs.selhtml)),s=rs.issuePOST(e+"&speed="+rs.thespeed+"&rsjs_ver="+rs.settings.version,rs.selhtml),r=document.getElementById(rs.data.current.playerid);if(!r){var n=document.createElement("div");n.setAttribute("id","rs_popup_player");var o=document.createDocumentFragment();o.appendChild(n),document.body.appendChild(o),r=document.getElementById(rs.data.current.playerid)}r.style.top=rs.popup.player_y_pos,r.style.left=rs.popup.player_x_pos;var a="<div style='height: 15px;'><span style='position: absolute; top: 0px; left: 0px;'><object type='application/x-shockwave-flash' data='"+rs.settings.flashLink+"?flv="+t+rs.settings.flashParams+"&rplayer=mini&text_play="+rs.phrases.play+"&text_pause="+rs.phrases.pause+"&text_stop="+rs.phrases.stop+"&text_vol="+rs.phrases.volume+"' style='height:20px; width:60px;'>";a+="<param name='movie' value='"+rs.settings.flashLink+"?flv="+t+rs.settings.flashParams+"&rplayer=mini&text_play="+rs.phrases.play+"&text_pause="+rs.phrases.pause+"&text_stop="+rs.phrases.stop+"&text_vol="+rs.phrases.volume+"'>",a+="<param name='quality' value='high'><param name='autostart' value='true'>",a+="<param name='allowScriptAccess' value='"+rs.settings.allowScriptAccess+"'><param name='bgcolor' value='#FFFFFF'>",a+="<param name='loop' value='false'><a id='rsSaveBtn' href='"+s+"' target='rs'>"+rs.phrases.nosound+"</a></object></span>",a+="<span style='position: absolute; top: 4px; right: 4px;'><a href='JavaScript:void(0);' onclick='rs.closepage(\""+rs.data.current.playerid+"\");return false'><img style='border-style: none !important; margin: 0px !important;' src='"+rs.settings.protocol+"//media.readspeaker.com/images/enterprise/default/close.png' title='"+rs.phrases.closeplayer+"' alt='"+rs.phrases.closeplayer+"'></a></span></div>",a+="<span id='rs_popup_link' style='position: absolute; top: 4px; right: 21px;'><a href='JavaScript:void(0);' onclick='rs.showcontrols(\""+e+'","'+rs.data.current.playerid+"\");return false'><img style='width: 13px; height: 13px; border-style: none !important;' src='"+rs.settings.protocol+"//media.readspeaker.com/images/enterprise/default/wrench.png' alt='"+rs.phrases.settings+"' title='"+rs.phrases.settings+"'></a></span>",a+="<div id='controls'></div>";var l=document.getElementById(rs.data.current.playerid);l&&(l.innerHTML=a,l.style.display="block")},hideIcon:function(){rs.popup.time&&clearTimeout(rs.popup.time),rs.popup.time=setTimeout("rs.popup.setVisibility()",2500)},setVisibility:function(){document.getElementById("rs_selimg")&&(document.getElementById("rs_selimg").style.display="none")},mousePress:function(e){if(!e)var e=window.event;return e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation(),e.pageX||e.pageY?rs.popup.mouse_y_startpos=e.pageY:(e.clientX||e.clientY)&&(rs.popup.mouse_y_startpos=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),!0},mouseRel:function(e){if(!e)var e=window.event;e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation();var t=null,s=null;return rs.popup.getViewportSize(),e.pageX||e.pageY?(t=e.pageY,s=e.pageX):(e.clientX||e.clientY)&&(t=e.clientY+document.body.scrollTop+document.documentElement.scrollTop,s=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft),t>rs.popup.mouse_y_startpos?t+20>rs.popup.viewportheight-30?rs.popup.mouse_y_pos=t-40:rs.popup.mouse_y_pos=t+20:10>t-40?rs.popup.mouse_y_pos=t+20:rs.popup.mouse_y_pos=t-40,5>s?rs.popup.mouse_x_pos=s+30:s>rs.popup.viewportwidth-80?rs.popup.mouse_x_pos=s-80:rs.popup.mouse_x_pos=s+15,!0},getViewportSize:function(){"undefined"!=typeof window.innerWidth?(rs.popup.viewportwidth=window.innerWidth+document.body.scrollLeft+document.documentElement.scrollLeft,rs.popup.viewportheight=window.innerHeight+document.body.scrollTop+document.documentElement.scrollTop):"undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientWidth&&0!=document.documentElement.clientWidth?(rs.popup.viewportwidth=document.documentElement.clientWidth+document.body.scrollLeft+document.documentElement.scrollLeft,rs.popup.viewportheight=document.documentElement.clientHeight+document.body.scrollTop+document.documentElement.scrollTop):(rs.popup.viewportwidth=document.getElementsByTagName("body")[0].clientWidth+document.body.scrollLeft+document.documentElement.scrollLeft,rs.popup.viewportheight=document.getElementsByTagName("body")[0].clientHeight+document.body.scrollTop+document.documentElement.scrollTop)}},base64:{encode:function(e){newdata=encodeURIComponent(e);for(var t=0,s=0,r=[];t<newdata.length;t++)newdata.charCodeAt(t)!="%".charCodeAt(0)?r[s]=newdata.charCodeAt(t):(r[s]=parseInt("0x"+newdata.charAt(t+1)+newdata.charAt(t+2)),t+=2),s++;var n,o=r.length,a=(4*parseInt((o+2)/3),new String),l=parseInt(o/3),i=o-3*l;for(t=0;3*l>t;t+=3)n=rs.base64.chars(r[t]>>2),a+=n,n=rs.base64.chars((3&r[t])<<4|r[t+1]>>4),a+=n,n=rs.base64.chars((15&r[t+1])<<2|r[t+2]>>6),a+=n,n=rs.base64.chars(63&r[t+2]),a+=n;return 1==i&&(a+=rs.base64.chars(r[t]>>2),a+=rs.base64.chars((3&r[t])<<4),a+="=",a+="="),2==i&&(a+=rs.base64.chars(r[t]>>2),a+=rs.base64.chars((3&r[t])<<4|r[t+1]>>4),a+=rs.base64.chars((15&r[t+1])<<2),a+="="),a},decode:function(e){for(var t="",s="",r=0,n=0,o="",a=e.length;a>r;)if(-1!=rs.base64.value(e[r])){for(o=e.substring(r,r+4),n=0,i=0;i<4;i++)"="==o[i]&&n++;for(i=0;i<3-n;i++){0==i?s=rs.base64.value(o[0])<<2|(48&rs.base64.value(o[1]))>>4:1==i?s=(15&rs.base64.value(o[1]))<<4|(60&rs.base64.value(o[2]))>>2:2==i&&(s=(3&rs.base64.value(o[2]))<<6|rs.base64.value(o[3]));var l=s.toString(16);1==l.length&&(l="0"+l),t+="%"+l}r+=4}else r++;return decodeURIComponent(t)},value:function(e){var t=e.charCodeAt(0);return t>="A".charCodeAt(0)&&t<="Z".charCodeAt(0)?t-"A".charCodeAt(0):t>="a".charCodeAt(0)&&t<="z".charCodeAt(0)?t-"a".charCodeAt(0)+26:t>="0".charCodeAt(0)&&t<="9".charCodeAt(0)?t-"0".charCodeAt(0)+52:t=="+".charCodeAt(0)?62:t=="/".charCodeAt(0)?63:-1},chars:function(e){return 26>e?String.fromCharCode(e+"A".charCodeAt(0)):52>e?String.fromCharCode(e+"a".charCodeAt(0)-26):62>e?String.fromCharCode(e+"0".charCodeAt(0)-52):62==e?"+":63==e?"/":String.fromCharCode(0)}},html5:{STATE_BEGIN:0,STATE_USER_START_NOT_READY:1,STATE_USER_START_PLAYING:2,state:0,inUse:!1,audioelement:null,lastcurrenttime:-1,currentsyncindex:0,oldbodyclass:null,lastevent:null,lastlastevent:null,lastlastlastevent:null,synclist:new Array,synclistindex:0,url:null,iframeurl:null,player:function(e){var t=Math.random();if(rs.settings.usePost){rs.html5.url=rs.issuePOST(e+"&requestgrouptype=html5iframe&sync="+rs.thesync+"&speed="+rs.thespeed+"&rsjs_ver="+rs.settings.version+"&audioformat=mp3&requestgroup="+t,"<div id='"+rs.data.current.readid+"'>"+rs.data.current.restorehtml+"</div>"),rs.html5.iframeurl=rs.issuePOST(e+"&requestgrouptype=html5iframe&sync="+rs.thesync+"&speed="+rs.thespeed+"&rsjs_ver="+rs.settings.version+"&audioformat=html5iframe&requestgroupid="+t,"<div id='"+rs.data.current.readid+"'>"+rs.data.current.restorehtml+"</div>");var s=rs.issuePOST(e+"&speed="+rs.thespeed+"&rsjs_ver="+rs.settings.version,"<div id='"+rs.data.current.readid+"'>"+rs.data.current.restorehtml+"</div>")}else{rs.html5.url=e+"&requestgrouptype=html5iframe&sync="+rs.thesync+"&speed="+rs.thespeed+"&rsjs_ver="+rs.settings.version+"&audioformat=mp3&requestgroup="+t,rs.html5.iframeurl=e+"&requestgrouptype=html5iframe&sync="+rs.thesync+"&speed="+rs.thespeed+"&rsjs_ver="+rs.settings.version+"&audioformat=html5iframe&requestgroupid="+t;var s=e+"&speed="+rs.thespeed+"&rsjs_ver="+rs.settings.version}rs.html5.oldbodyclass=document.body.className,document.body.className+=" rs_iphone";var r="<div id='rs_playerarea' style='width:285px; height: 39px;'><div style='margin-bottom: 2px; width: 100%; height: 20px;'>";r+="<div style='position: absolute; top: 4px; left: 4px;'><a id='rs_playbtn' href='JavaScript:void(0);'><img id='rs_playimg' style='border-style: none !important; margin: 0px !important; padding:0px !important;' src='https://media.readspeaker.com/images/enterprise/default/play2.png' title='"+rs.phrases.play+"' alt='"+rs.phrases.play+"'></a></div>",r+="<div style='position: absolute; top: 4px; left: 21px;'><a id='rs_pausebtn' href='JavaScript:void(0);'><img id='rs_pauseimg' style='border-style: none !important; margin: 0px !important; padding:0px !important;' src='https://media.readspeaker.com/images/enterprise/default/pause.png' title='"+rs.phrases.pause+"' alt='"+rs.phrases.pause+"'></a></div>",r+="<div style='position: absolute; top: 4px; left: 38px;'><a id='rs_stopbtn' href='JavaScript:void(0);'><img id='rs_stopimg' style='border-style: none !important; margin: 0px !important; padding:0px !important;' src='http://media.readspeaker.com/images/enterprise/default/stop.png' title='"+rs.phrases.stop+"' alt='"+rs.phrases.stop+"'></a></div>",r+="<div id='timeline'><div id='duration'></div><span id='durationtxt'></span></div>",r+="<div style='position: absolute; top: 2px; left: 231px;'><a href='http://www.readspeaker.com'><img style='border-style: none !important; margin: 0px !important; padding:0px !important;' src='http://media.readspeaker.com/images/buttons/listen_icons/icon_16px.gif' title='Go to the ReadSpeaker website' alt='Go to the ReadSpeaker website' /></a></div>",r+="<span style='position: absolute; top: 4px; right: 4px;'><a style='border-style: none;' href='JavaScript:void(0);' onclick='rs.html5.stop();rs.closepage(\""+rs.data.current.playerid+"\");return false'><img style='border-style: none !important; margin: 0px !important;' id='closebr' src='http://media.readspeaker.com/images/enterprise/default/close.png' alt='"+rs.phrases.closeplayer+"' title='"+rs.phrases.closeplayer+"'></a></span></div>",r+="<div id='bottomlinks'><a href='JavaScript:void(0);' class='rs_settings' onclick='rs.showcontrols(\""+e+'","'+rs.data.current.playerid+"\");return false'>"+rs.phrases.settings+"</a> | <a id='rsSaveBtn' href='"+s+"' target='rs'>"+rs.phrases.nosound+"</a> | "+rs.phrases.speechenabled+"</div>",r+="<div id='controls'></div>",r+="</div>";var n=document.getElementById(rs.data.current.playerid);n&&(n.innerHTML=r,n.style.display="block"),rs.html5.start()},start:function(){rs.html5.stop();var e=null;rs.html5.audioelement=new Audio(rs.html5.url),rs.html5.audioelement.setAttribute("controls","controls"),rs.html5.audioelement.loop=!1,rs.html5.audioelement.play(),rs.html5.audioelement.addEventListener("ended",rs.html5.controls.stop,!1),rs.html5.audioelement.addEventListener("timeupdate",rs.html5.controls.timer,!1);var t=document.getElementById("rs_playbtn");t.addEventListener("click",rs.html5.controls.play,!1);var s=document.getElementById("rs_pausebtn");s.addEventListener("click",rs.html5.controls.pause,!1);var r=document.getElementById("rs_stopbtn");r.addEventListener("click",rs.html5.controls.stop,!1),"none"!=rs.thesync?(document.getElementById("synciframe")?e=document.getElementById("synciframe"):(e=document.createElement("iframe"),e.setAttribute("id","synciframe")),e.src=rs.html5.iframeurl,e.type="text/javascript",e.height=0,e.width=0,e.style.display="none",document.body.appendChild(e),rs.html5.refresh()):rs.html5.state=rs.html5.STATE_USER_START_PLAYING},controls:{play:function(){rs.html5.audioelement?rs.html5.audioelement.play():rs.html5.start(rs.html5.url),document.getElementById("rs_playimg")&&document.getElementById("rs_playimg").setAttribute("src","http://media.readspeaker.com/images/enterprise/default/play2.png"),document.getElementById("rs_pauseimg")&&document.getElementById("rs_pauseimg").setAttribute("src","http://media.readspeaker.com/images/enterprise/default/pause.png"),document.getElementById("rs_stopimg")&&document.getElementById("rs_stopimg").setAttribute("src","http://media.readspeaker.com/images/enterprise/default/stop.png")},pause:function(){setTimeout("rs.html5.audioelement.pause()",200),document.getElementById("rs_pauseimg")&&document.getElementById("rs_pauseimg").setAttribute("src","http://media.readspeaker.com/images/enterprise/default/pause2.png"),document.getElementById("rs_playimg")&&document.getElementById("rs_playimg").setAttribute("src","http://media.readspeaker.com/images/enterprise/default/play.png")},stop:function(){rs.html5.audioelement&&rs.html5.audioelement.removeEventListener("timeupdate",rs.html5.controls.timer,!1),rs.html5.stop(),rs.rshlexit(),document.getElementById("rs_stopimg")&&document.getElementById("rs_stopimg").setAttribute("src","http://media.readspeaker.com/images/enterprise/default/stop2.png"),document.getElementById("rs_playimg")&&document.getElementById("rs_playimg").setAttribute("src","http://media.readspeaker.com/images/enterprise/default/play.png"),document.getElementById("rs_pauseimg")&&document.getElementById("rs_pauseimg").setAttribute("src","http://media.readspeaker.com/images/enterprise/default/pause2.png");var e=document.getElementById("duration");e.style.width="0%";var t=document.getElementById("durationtxt");t.innerHTML="00:00 | 00:00"},timer:function(){if(rs.html5.audioelement){var e=document.getElementById("duration"),t=document.getElementById("durationtxt"),s=rs.html5.audioelement.duration,r=rs.html5.audioelement.currentTime;if(e.style.width=r/s*100+"%",s)var n=parseInt(s%60)+"",o=parseInt(s/60%60)+"",a=parseInt(s/60/60%60)+"";else var n="00",o="00",a="";var l=parseInt(rs.html5.audioelement.currentTime%60)+"",i=parseInt(rs.html5.audioelement.currentTime/60%60)+"",d=parseInt(rs.html5.audioelement.currentTime/60/60%60)+"";0!=a?(a.length<2&&(a=0+a+":"),d.length<2&&(d=0+d+":")):(a="",d=""),o.length<2&&(o=0+o),n.length<2&&(n=0+n),i.length<2&&(i=0+i),l.length<2&&(l=0+l),s?t.innerHTML=d+i+":"+l+" | "+a+o+":"+n:t.innerHTML="00:00 | 00:00"}}},stop:function(){if(rs.html5.state!=rs.html5.STATE_BEGIN){rs.html5.audioelement&&rs.html5.audioelement.pause(),rs.html5.audioelement=null;var e=document.getElementById("synciframe");e&&(e.src="about:blank")}rs.html5.state=rs.html5.STATE_BEGIN,rs.html5.lastcurrenttime=-1,rs.html5.currentsyncindex=0,rs.html5.synclistindex=0,rs.html5.synclist=[]},receiveMessage:function(e){e.origin.match(/readspeaker.com/gi)&&(null!=rs.html5.lastevent&&"rshlsetContent"==e.data?rshlsetContent(rs.base64.decode(rs.html5.lastevent.data)):null!=rs.html5.lastevent&&"rshlsetId"==e.data?rshlsetId(rs.html5.lastevent.data):"rshlinit"==e.data?rshlinit():null!=rs.html5.lastlastlastevent&&null!=rs.html5.lastlastevent&&null!=rs.html5.lastevent&&"rshlsync"==e.data&&(rs.html5.synclist[rs.html5.synclistindex]=[rs.html5.lastlastlastevent.data,rs.html5.lastlastevent.data,rs.html5.lastevent.data],rs.html5.synclistindex++),rs.html5.lastlastlastevent=rs.html5.lastlastevent,rs.html5.lastlastevent=rs.html5.lastevent,rs.html5.lastevent=e)},refresh:function(){if(rs.html5.audioelement){if(rs.html5.lastcurrenttime>rs.html5.audioelement.currentTime)return void rs.html5.controls.stop();if(rs.html5.lastcurrenttime=rs.html5.audioelement.currentTime,rs.html5.state==rs.html5.STATE_BEGIN)rs.html5.audioelement.pause(),rs.html5.state=rs.html5.STATE_USER_START_NOT_READY,setTimeout("rs.html5.refresh()",0);else if(rs.html5.state==rs.html5.STATE_USER_START_NOT_READY)if(rs.html5.synclist[rs.html5.currentsyncindex]&&rs.html5.audioelement.buffered&&rs.html5.audioelement.buffered.length>0&&rs.html5.synclist[rs.html5.currentsyncindex][0]<1e3*rs.html5.audioelement.buffered.end(0))rs.html5.state=rs.html5.STATE_USER_START_PLAYING,rs.html5.audioelement.play(),setTimeout("rs.html5.refresh()",0);else if(rs.html5.synclist[rs.html5.currentsyncindex])if(1*rs.html5.synclist[rs.html5.currentsyncindex][0]-1e3*rs.html5.audioelement.currentTime<=20)setTimeout("rs.html5.refresh()",0);else{var e=1*rs.html5.synclist[rs.html5.currentsyncindex][0]-1e3*rs.html5.audioelement.currentTime-20;e>75?setTimeout("rs.html5.refresh()",75):0>e?setTimeout("rs.html5.refresh()",0):setTimeout("rs.html5.refresh()",e)}else setTimeout("rs.html5.refresh()",75);else if(rs.html5.state==rs.html5.STATE_USER_START_PLAYING)if(rs.html5.synclist[rs.html5.currentsyncindex]&&1*rs.html5.synclist[rs.html5.currentsyncindex][0]-20<1e3*rs.html5.audioelement.currentTime)if(rshlsync(rs.html5.synclist[rs.html5.currentsyncindex][1],rs.html5.synclist[rs.html5.currentsyncindex][2]),rs.html5.currentsyncindex++,rs.html5.synclist[rs.html5.currentsyncindex])if(1*rs.html5.synclist[rs.html5.currentsyncindex][0]-1e3*rs.html5.audioelement.currentTime<=20)setTimeout("rs.html5.refresh()",0);else{var e=1*rs.html5.synclist[rs.html5.currentsyncindex][0]-1e3*rs.html5.audioelement.currentTime-20;e>75?setTimeout("rs.html5.refresh()",75):0>e?setTimeout("rs.html5.refresh()",0):setTimeout("rs.html5.refresh()",e)}else setTimeout("rs.html5.refresh()",75);else if(rs.html5.synclist[rs.html5.currentsyncindex])if(1*rs.html5.synclist[rs.html5.currentsyncindex][0]-1e3*rs.html5.audioelement.currentTime<=20)setTimeout("rs.html5.refresh()",0);else{var e=1*rs.html5.synclist[rs.html5.currentsyncindex][0]-1e3*rs.html5.audioelement.currentTime-20;e>75?setTimeout("rs.html5.refresh()",75):0>e?setTimeout("rs.html5.refresh()",0):setTimeout("rs.html5.refresh()",e)}else setTimeout("rs.html5.refresh()",75)}}}};document.addEventListener?(document.addEventListener("mousedown",rs.popup.mousePress,!1),document.addEventListener("keydown",rs.popup.mousePress,!1),document.addEventListener("mouseup",rs.copyselected,!1),document.addEventListener("keyup",rs.copyselected,!1),window.addEventListener("message",rs.html5.receiveMessage,!1,!0)):document.attachEvent?(document.attachEvent("onmousedown",rs.popup.mousePress),document.attachEvent("onkeydown",rs.popup.mousePress),document.attachEvent("onmouseup",rs.copyselected),document.attachEvent("onkeyup",rs.copyselected)):(document.onmousedown=rs.popup.mousePress,document.onkeydown=rs.popup.mousePress,document.onmouseup=rs.copyselected,document.onkeyup=rs.copyselected);var thestylesheet="<style type='text/css'> ";thestylesheet+="#rs_playerarea { position: relative !important; border:1px solid #aeaeae !important; background:#ffffff !important; width: "+rs.phrases.playerwidth+"px !important; height: 39px !important; line-height: normal !important; font-style: normal !important;font-family:Arial !important;}",thestylesheet+="#rs_playerarea object { max-width: none !important; }",thestylesheet+="#closebr { border-style: none !important; margin: 0px !important; padding: 0px !important; }",thestylesheet+="#rs_popup_player { font-family: Arial !important; font-size: 13px !important; width: 97px !important; height: 22px !important; position: absolute !important; border: 1px solid #aeaeae !important; z-index: 9000 !important; background: #fff !important; -moz-box-shadow: 2px 4px 6px #999 !important; -webkit-box-shadow: 2px 4px 6px #999 !important; -box-shadow: 2px 4px 6px #999 !important; line-height: normal !important;}",thestylesheet+="#rs_popup_link a:hover { background-color: #a4cbff !important; } #rs_selimg { position: absolute !important; border: 1px solid #aeaeae !important; z-index: 10000 !important; background: #fff !important; padding: 5px !important; -moz-box-shadow: 2px 4px 6px #999 !important; -webkit-box-shadow: 2px 4px 6px #999 !important; -box-shadow: 2px 4px 6px #999 !important; line-height: normal !important; }",thestylesheet+="#rspopup { position: absolute !important; z-index: 1000 !important; background: #fff !important; width: 342px !important; border-color: #a4cbff #aeaeae #aeaeae !important; border-right: 1px solid #aeaeae !important; border-style: solid !important; border-width: 1px !important; margin: 3px 3px 3px 0 !important; font-size: 12px !important; font-family: Arial !important; padding: 3px !important; -moz-box-shadow: 0 7px 6px #999 !important; -webkit-box-shadow: 0 7px 6px #999 !important; -box-shadow: 0 7px 6px #999 !important; }",thestylesheet+=".rs_block {float: left !important; margin: 0 3px 0 0 !important; padding: 3px !important; border: 1px solid #ddd !important; width: 160px !important; background: none !important; clear: none !important; font-family: inherit !important;}",thestylesheet+=".rs_block legend { position: static !important; font-weight: bold !important; color: #000 !important; font-size: 12px !important; text-transform: none !important; letter-spacing: 0px !important; padding: 0px !important; font-style: inherit !important; font-family: inherit !important; }",thestylesheet+=".rs_block ul { margin: 0 !important; padding: 0 !important; list-style: none !important; width: 100% !important; font-family: inherit !important;}",thestylesheet+=".rs_block li { padding: 0 !important; margin: 0 !important; width: 100% !important; background: none !important; list-style-image: none !important; list-style-type: none !important; font-family: inherit !important;}",thestylesheet+=".rs_block li a { text-align: left !important; border-style: none !important; display: block !important; padding: 5px 0 5px 20px !important; text-decoration: none !important; color: #000 !important; font-size: 12px !important; font-family: inherit !important; font-weight: normal !important; width: 87% !important; }",thestylesheet+=".rs_block li a:hover { background: #eee !important; }",thestylesheet+=".rs_block li.rs_active { background-color: #A4CBFF !important; background-image: -webkit-gradient(linear, left bottom, left top, color-stop(0, rgb(144,192,240)), color-stop(0.79, rgb(229,237,255))) !important; background-image: -moz-linear-gradient(center bottom, rgb(144,192,240) 0%, rgb(229,237,255) 79%) !important; }",thestylesheet+=".rs_block li.rs_active a, .rs_block li.rs_active a:hover { background: transparent url("+rs.settings.protocol+"//media.readspeaker.com/images/enterprise/default/rs_arrow.gif) no-repeat scroll 10px center !important; }",thestylesheet+="#bottomlinks { font-family: inherit !important;color:#333 !important;font-size:11px !important; margin: 2px 0 2px 0 !important;} #bottomlinks a {color: #000 !important; border-style: none !important; text-decoration: none !important; padding: 2px; font-weight: normal !important; font-size:11px !important; font-family: inherit !important;} #bottomlinks a:hover { background-color: #a4cbff !important; }",thestylesheet+="a.rs_settings { padding-left: 17px !important; border-style: none !important; background: transparent url("+rs.settings.protocol+"//media.readspeaker.com/images/enterprise/default/wrench.png) no-repeat 2px 2px !important;}",thestylesheet+=".sync_word_highlighted { background-color: "+rs.settings.wordColor+" !important; color: "+rs.settings.textColor+" !important; }",thestylesheet+=".sync_sent_highlighted { background-color: "+rs.settings.sentColor+" !important; color: "+rs.settings.textColor+" !important; }",thestylesheet+="#timeline { position: absolute !important; top: 4px !important; left: 55px !important; height: 11px !important; background-color: #F4F4F4 !important; width: 170px !important; border: 1px solid #3380CC !important; }",thestylesheet+="#duration { position: relative !important; height: 11px !important; background-color: #92C0EF !important; width: 0px;} ",thestylesheet+="#durationtxt { position: absolute !important; top: 1px !important; left: 0px !important; text-align: center !important; font-size: 10px !important; font-weight: bold !important; font-family: Helvetica !important; color: #003399 !important; line-height: 80% !important; width: 100% !important; } .rs_iphone { -webkit-text-size-adjust: none !important; }",thestylesheet+="</style>",document.write(thestylesheet);